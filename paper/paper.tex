\documentclass[conference]{IEEEtran}
\IEEEoverridecommandlockouts
% The preceding line is only needed to identify funding in the first
% footnote. If that is unneeded, please comment it out.

\usepackage{booktabs}
\usepackage{url}
\usepackage{multirow}
\usepackage{tikz}
\usetikzlibrary{matrix,fit,shapes,calc,positioning,shadows,arrows,shapes,backgrounds,decorations.markings,fadings}
\usepackage{listings}
\usepackage[caption=false, font=footnotesize]{subfig}
%%%%%%%%%%%%% code listing
\renewcommand{\ttdefault}{pcr}
\lstset{
  basicstyle=\scriptsize\ttfamily,
  keywordstyle=\scriptsize\ttfamily\bfseries,
  language=C,             % choose the language of the code
  frame=single,              % adds a frame around the code
  aboveskip=0pt,
  belowskip=0pt,
  breaklines=true,           % sets automatic line breaking
  breakatwhitespace=false,   % sets if automatic breaks should only happen at
  showspaces=false,
  %numbersep=5pt,              % Abstand der Nummern zum Text
  %tabsize=2,                  % Groesse von Tabs
  %extendedchars=true,         %
  %breaklines=true,            % Zeilen werden Umgebrochen
  keywords=[2]{tcp, flag, threshold, track, count, seconds, classtype, sid}
}
\usepackage{balance}
\usepackage{wrapfig}
\usepackage{enumitem}
\usepackage{color, colortbl}
\definecolor{Gray}{gray}{0.9}

\input{macros}


%% \usepackage{cite}
%% \usepackage{amsmath,amssymb,amsfonts}
%% \usepackage{algorithmic}
%% \usepackage{graphicx}
%% \usepackage{textcomp}
%% \usepackage{xcolor}

\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
\begin{document}

\title{Search-based Synthesis of Network Intrusion Detection Rules}

%%%%%%%%%%% Anonymized

%% \author{\IEEEauthorblockN{1\textsuperscript{st} Given Name Surname}
%% \IEEEauthorblockA{\textit{dept. name of organization (of Aff.)} \\
%% \textit{name of organization (of Aff.)}\\
%% City, Country \\
%% email address}
%% \and
%% \IEEEauthorblockN{2\textsuperscript{nd} Given Name Surname}
%% \IEEEauthorblockA{\textit{dept. name of organization (of Aff.)} \\
%% \textit{name of organization (of Aff.)}\\
%% City, Country \\
%% email address}
%% \and
%% \IEEEauthorblockN{3\textsuperscript{rd} Given Name Surname}
%% \IEEEauthorblockA{\textit{dept. name of organization (of Aff.)} \\
%% \textit{name of organization (of Aff.)}\\
%% City, Country \\
%% email address}
%% \and
%% \IEEEauthorblockN{4\textsuperscript{th} Given Name Surname}
%% \IEEEauthorblockA{\textit{dept. name of organization (of Aff.)} \\
%% \textit{name of organization (of Aff.)}\\
%% City, Country \\
%% email address}
%% \and
%% \IEEEauthorblockN{5\textsuperscript{th} Given Name Surname}
%% \IEEEauthorblockA{\textit{dept. name of organization (of Aff.)} \\
%% \textit{name of organization (of Aff.)}\\
%% City, Country \\
%% email address}
%% \and
%% \IEEEauthorblockN{6\textsuperscript{th} Given Name Surname}
%% \IEEEauthorblockA{\textit{dept. name of organization (of Aff.)} \\
%% \textit{name of organization (of Aff.)}\\
%% City, Country \\
%% email address}
%% }

\maketitle

\begin{abstract}
This document is a model and instructions for \LaTeX.
This and the IEEEtran.cls file define the components of your paper [title, text, heads, etc.]. *CRITICAL: Do Not Use Symbols, Special Characters, Footnotes, 
or Math in Paper Title or Abstract.
\end{abstract}

\begin{IEEEkeywords}
component, formatting, style, styling, insert
\end{IEEEkeywords}

\section{Introduction}

Network Intrusion Detection Systems (\nids{}) are software systems
that monitor the network traffic for malicious behavior and act
accordingly by blocking messages or alerting humans about suspicious
events~\cite{Mitchell:2014:SID:2597757.2542049}. \nids{} are typically
placed behind a firewall, vetting the traffic that the firewall did
not block. Various open-source (\eg{}, Snort~\cite{snort} and
Suricata~\cite{suricata}) and commercial implementations (\eg{},
SolarWinds~\cite{solarwinds} and IBM QRadar~\cite{qradar}) exist
today. These systems are very popular in industry to secure local
computer networks given the amount of potential malicious traffic that
exist on the Internet today.

%% The
%% hypothesis of anomaly-based \nids\ is that attack manifestations
%% produces traffic that deviates from regular benign traffic that has
%% been already observed by the network and that deviation is
%% noticeable. 

\sloppy \nids{} are typically categorized in two
groups~\cite{kumar2007survey}: 1)~rule-based and 2)~anomaly-based. A
rule-based \nids{} (\aka\ signature-based NIDS) checks if the network
traffic matches a fixed set of
rules. Figure~\ref{fig:synflood-example} shows an example rule of
Suricata~\cite{suricata}, a popular open-source \nids{}. This rule
prescribes a method to capture SYN flood
attacks~\cite{Douligeris:2004:DAD:987153.987158} that can result in
denial of service of a server. Rule-based \nids{} focuses on known
attacks whereas anomaly-based \nids{} focuses on suspicious
unanticipated network traffic, referred to as anomalies. Anomaly-based
\nids{}, specially those that use machine learning, have shown useful
specially for detecting denial of service
attacks~\cite{cordy-etal-issta19}. In that scenario, determining the right
threshold on the rate/volume of network accesses that should trigger
an alarm is challenging.

Rule-based and Anomaly-based NIDS are complementary. This paper
proposes a synthesis technique, dubbed \tname{}, to automatically
create rules from positive and negative examples (\ie{}, benign and
malicious traffic) provided as input. The main scenario of application
is one where anomaly-based NIDS identify abnormal traffic and signals
that to \tname{} to craft rules that can be used by rule-based
NIDS. It is worth noting that attackers are very productive in
creating ways to circumvent existing protections and manual creation
of rules is tedious and time-consuming.\Mar{Lucas/Guilherme: (IMP) supporting data?}
Consequently, synthesis of rules can circumvent those issues.

\Mar{--------------------------------- parei aqui}

focuses on rule-based \nids{}, which are already very
popular both in industry and academia. Our analysis focuses on
Suricata, but it applies to any other rule-based \nids{}.


%Despite the great success of rule-based \nids{},

Mantaining \nids{} rules can be a daunting activity. Although the
\nids{} typically provides a set of pre-defined rules, such ruleset is
neither necessary nor sufficient. More precisely:

\begin{enumerate}
\item enabling all possible rules is not practical;
\item rules not in the original rule set may need to be added in a
  given setup.
\end{enumerate}

The first statement is consequential of the inherent physical
limitation of rule-based \nids{}. The cost of checking rules is
proportional to the traffic load and the number of enabled rules. If
system capacity is insufficient to support the load, the intrusion
detector can miss packets and attacks\Fix{I guess we have some
  reference for this.}. To cope with that issue, system administrators
block certain protocols on the firewall and configure the \nids{} to
use a selection of rules that apply to the authorized traffic.  The
task of selecting rules that are applicable can be non-trivial as it
depends on the set of firewall rules enabled on the network.

The second statement is supported by the observation that
\numundetected{} of the attacks produced by
Metasploit~\cite{metasploit}, a popular open-source penetration
testing tool, are undetected by \suri{}. For example,
\Fix{...}. (Section~\ref{sec:suri-metas-coverage} provides more
details.) Unfortunately, manually creating those rules from scratch
can be time-consuming and error-prone. Figure~\Fix{...}  shows an
example rule illustrating the complexity of the Suricata rule
language\footnote{Suricata extends the language used by
  Snort~\cite{snort}.}.  In addition, looking for rules from untrusted
sources (say, the internet) is unreliable. Collectively, these issues
suggest that synthesizing \nids{} rules is an important aid for system
administrators.

\Fix{why is that challenging (worth of research)?}

This paper makes the following contributions. \Fix{...}

\section{Illustrative Example}
\label{sec:suri-metas-coverage}

Figure~\ref{fig:synflood-example} shows an
example rule of Suricata~\cite{suricata}, a popular open-source
\nids{}, maintained by the Open Information Security Foundation
(OISF)~\cite{oisf}. This example shows how Suricata can be used to
protect against SYN flood attacks. A TCP connection is typically
established with a 3-way handshake. First, the client sends a SYN
packet to the server, requesting a connection. Second, the server
responds with SYN-ACK packet to the client. Third, the client responds
with an ACK message and the connection is established. Aware of the
protocol, an attacker sends multiple SYN packets to different ports of
a server, often using fake IP addresses. Without proper protection,
the server accepts the connection requests and eventually legitimate
connection requests cannot be satisfied due to resource exhaustion.

\begin{figure}[t]
  \lstinputlisting[language=C,numbers=none]{synflood.suricata}
  \caption{Suricata rule for SYN Flood Attacks.\Mar{colocar
      propriedades em negrito}}
  \label{fig:synflood-example}
\end{figure}

\Mar{Lucas/Guilherme (CRI): por favor, explique o formato de uma regra do
  Suricata e, em seguida, explique esta regra, detalhando o
  significado de cada propriedade/campo.}

\section{Approach}

\Fix{...}

\section{Evaluation}

\Mar{Lucas/Guilherme (CRI): vcs. precisam dar pontape inicial (bom
  exercicio) propondo perguntas de pesquisa. Eu faco ajustes em seguida.}

\section{Threats to Validity}

External Validity. \Fix{elaborate ...how popular are Suricata/Metasploit?}

\section{Related Work}

\Fix{...}

\balance
%\vspace*{-2\baselineskip}
\bibliographystyle{IEEEtran}
\bibliography{references}

\end{document}

%%  LocalWords:  Suricata SolarWinds QRadar NIDS OISF TCP ACK
