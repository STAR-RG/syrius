\documentclass[conference]{IEEEtran}
\IEEEoverridecommandlockouts
% The preceding line is only needed to identify funding in the first
% footnote. If that is unneeded, please comment it out.

\usepackage{booktabs}
\usepackage{cite}
\usepackage{url}
\usepackage{multirow}
\usepackage{tikz}
\usetikzlibrary{matrix,fit,shapes,calc,positioning,shadows,arrows,shapes,backgrounds,decorations.markings,fadings}
\usepackage{listings}
\usepackage[caption=false, font=footnotesize]{subfig}
%%%%%%%%%%%%% code listing
\renewcommand{\ttdefault}{pcr}
\lstset{
  basicstyle=\scriptsize\ttfamily,
  keywordstyle=\scriptsize\ttfamily\bfseries,
  language=C,             % choose the language of the code
  frame=single,              % adds a frame around the code
  aboveskip=0pt,
  belowskip=0pt,
  breaklines=true,           % sets automatic line breaking
  breakatwhitespace=false,   % sets if automatic breaks should only happen at
  showspaces=false,
  %numbersep=5pt,              % Abstand der Nummern zum Text
  %tabsize=2,                  % Groesse von Tabs
  %extendedchars=true,         %
  %breaklines=true,            % Zeilen werden Umgebrochen
  keywords=[2]{tcp, flag, threshold, track, count, seconds, classtype, sid}
}
\usepackage{balance}
\usepackage{wrapfig}
\usepackage{enumitem}
\usepackage{color, colortbl}
\definecolor{Gray}{gray}{0.9}

\input{macros}


%% \usepackage{cite}
%% \usepackage{amsmath,amssymb,amsfonts}
%% \usepackage{algorithmic}
%% \usepackage{graphicx}
%% \usepackage{textcomp}
%% \usepackage{xcolor}

\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
\begin{document}

\title{Search-based Synthesis of Network Intrusion Detection Rules}

%%%%%%%%%%% Anonymized

%% \author{\IEEEauthorblockN{1\textsuperscript{st} Given Name Surname}
%% \IEEEauthorblockA{\textit{dept. name of organization (of Aff.)} \\
%% \textit{name of organization (of Aff.)}\\
%% City, Country \\
%% email address}
%% \and
%% \IEEEauthorblockN{2\textsuperscript{nd} Given Name Surname}
%% \IEEEauthorblockA{\textit{dept. name of organization (of Aff.)} \\
%% \textit{name of organization (of Aff.)}\\
%% City, Country \\
%% email address}
%% \and
%% \IEEEauthorblockN{3\textsuperscript{rd} Given Name Surname}
%% \IEEEauthorblockA{\textit{dept. name of organization (of Aff.)} \\
%% \textit{name of organization (of Aff.)}\\
%% City, Country \\
%% email address}
%% \and
%% \IEEEauthorblockN{4\textsuperscript{th} Given Name Surname}
%% \IEEEauthorblockA{\textit{dept. name of organization (of Aff.)} \\
%% \textit{name of organization (of Aff.)}\\
%% City, Country \\
%% email address}
%% \and
%% \IEEEauthorblockN{5\textsuperscript{th} Given Name Surname}
%% \IEEEauthorblockA{\textit{dept. name of organization (of Aff.)} \\
%% \textit{name of organization (of Aff.)}\\
%% City, Country \\
%% email address}
%% \and
%% \IEEEauthorblockN{6\textsuperscript{th} Given Name Surname}
%% \IEEEauthorblockA{\textit{dept. name of organization (of Aff.)} \\
%% \textit{name of organization (of Aff.)}\\
%% City, Country \\
%% email address}
%% }

\maketitle

\begin{abstract}
...
\end{abstract}

\begin{IEEEkeywords}
NIDS, synthesis, search
\end{IEEEkeywords}

\section{Introduction}

Network Intrusion Detection Systems (\nids{}) are software systems
that monitor the network traffic for malicious behavior and act
accordingly by blocking messages or alerting humans about suspicious
events~\cite{Mitchell:2014:SID:2597757.2542049}. \nids{} are typically
placed behind a firewall, vetting the traffic that the firewall did
not block. Various open-source (\eg{}, Snort~\cite{snort} and
Suricata~\cite{suricata}) and commercial implementations (\eg{},
SolarWinds~\cite{solarwinds} and IBM QRadar~\cite{qradar}) exist
today. These systems are very popular in industry to secure local
computer networks given the amount of potential malicious traffic that
exist on the Internet today.

\sloppy \nids{} are typically categorized in two
groups~\cite{kumar2007survey}: 1)~rule-based and 2)~anomaly-based. A
rule-based \nids{} (\aka\ signature-based NIDS) checks if the network
traffic matches a fixed set of
rules. Figure~\ref{fig:synflood-example} shows an example rule of
Suricata~\cite{suricata}, a popular open-source \nids{}. This rule
prescribes a method to capture SYN flood attacks to a
server~\cite{Douligeris:2004:DAD:987153.987158} that can result in
denial of service. Rule-based \nids{} focuses on known attacks whereas
anomaly-based \nids{} focuses on unanticipated attacks that could be
observed through suspicious network
traffic~\cite{kumar2007survey,Mitchell:2014:SID:2597757.2542049,cordy-etal-issta19}.

Rule-based and Anomaly-based NIDS are complementary. This paper
proposes a technique, dubbed \tname{}, to automatically synthesize
rules from positive and negative examples (\ie{}, benign and malicious
traffic). The main scenario of application is one where an
anomaly-based NIDS identifies abnormal traffic and signals that
traffic to \tname{} to craft rules that can be used by rule-based
NIDS. The core motivation is that attackers are productive in creating
new ways to circumvent existing protections and manual creation of
rules is tedious and time-consuming.\Mar{Lucas/Guilherme: (IMP) do we
  have data to support this?} For those reasons, synthesizing rules to
circumvent those issues is an important problem.

\Fix{summarize how the technique works}

\Fix{summarize results}

This paper makes the following contributions. \Fix{...}

\section{Illustrative Example}
\label{sec:suri-metas-coverage}

This section 1) shows an example rule of Suricata and briefly explains
the format of Suricata rules, 2) presents an example of
a network attack, and 3) illustrates how \tname{} performs to
synthesize the rule that would capture the attack.

\subsection{Suricata Rules}

\Mar{Lucas/Guilherme, verifique se isto esta correto}
Figure~\ref{fig:synflood-example} shows an example rule of
Suricata~\cite{suricata}, a popular open-source \nids{} maintained by
the Open Information Security Foundation (OISF)~\cite{oisf}. A
Suricata rule is divided in three
parts---action, header, and rule options~\cite{suri-rule-format}. The
action part appears as the first word in the rule description. In this
case, \CodeIn{alert}. An action denotes the task that needs to be
executed if the rule pattern is satisfied. In this case, a message
will be sent to sys admins if the rule pattern is satisfied. Other
options of actions include pass, drop, and reject. The
header comes after the action in the rule description. It restricts
the information flow covered by the rule. For this rule, the header is
\CodeIn{tcp \$HOME\_NET any -> \$EXTERNAL\_NET any}, which instructs Suricata
to inspect \CodeIn{tcp} traffic flowing from any port in the
home network to any other address outside the home network. The
variables \CodeIn{\$HOME\_NET} and \CodeIn{\$EXTERNAL\_NET} are configurable. The rule
options come after the header. It is a semi-colon-separated sequence
of key-value pairs characterizing the attack pattern. For example,
\Mar{Lucas/Guilherme (IMP): explique o que cada propriedade faz...}

\subsection{SYN Flood Attack}

The SYN Flood attack exploits a vulnerability in the TCP/IP handshake
to establish a TCP connection~\cite{cloudfare-synflood}. The handshake
works as follows. First, a client sends a SYN packet to the server,
requesting a connection. Second, the server responds with SYN-ACK
packet to the client. Third, the client responds with an ACK message
and the connection is established.

Aware of the
protocol, an attacker sends multiple SYN packets to different ports of
a server, often using fake IP addresses. Without proper protection,
the server accepts the connection requests and eventually legitimate
connection requests cannot be satisfied due to resource exhaustion.

\begin{figure}[t]
  \lstinputlisting[language=C,numbers=none]{synflood.suricata}
  \caption{Suricata rule for SYN Flood Attacks.\Mar{colocar
      propriedades em negrito}}
  \label{fig:synflood-example}
\end{figure}

\subsection{\tname\ on SYN Flood Attack}

\Mar{Guilherme/Lucas (CRI): we need to show how \tname{} works on this
  example. What is the input? How long does it take to generate the
  rule? Is the rule generate exactly the same?}

\section{Approach}

\Fix{...}

\section{Evaluation}

\Mar{Lucas/Guilherme (CRI): precisamos dar pontape inicial propondo
  perguntas de pesquisa. Eu faco ajustes em seguida.}

\section{Threats to Validity}

External Validity. \Fix{elaborate ...how popular are Suricata/Metasploit?}

\section{Related Work}

\Fix{...}

\balance
%\vspace*{-2\baselineskip}
\bibliographystyle{IEEEtran}
\bibliography{references}

\end{document}

%%  LocalWords:  Suricata SolarWinds QRadar NIDS OISF TCP ACK
